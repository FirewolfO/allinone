# 一、JVM有哪些？

## 虚拟机始祖：Sun Classic

第一款JVM，只能使用纯解释器模式执行Java代码，可以通过外挂方式使用JIT编译器，JIT编译器和解释器不可共存；



## 无疾而终：Sun Exact VM

 Exact VM 中使用了准确式内存管理（Exact Memory Management），即虚拟机可以知道内存中某个位置的数据具体是什么类型，这样就减少了查找的的开销，提升执行性能。可以一直没有很大规模的使用



## 武林盟主：Sun HotSpot VM

SUN收购的Longview Technologies 公司的；

要说 HotSpot 不仅仅有前面说到两款虚拟机的优点（如：准确式内存管理），也有许多自己的新技术，例如：热点探测技术。



## 百家争鸣：BEA JRockit / IBM J9 VM

BEA 公司的 JRockit 是一款专注于服务器硬件和服务端应用场景的虚拟机，其针对服务端场景做了大量的优化，因此其不太关注程序启动速度。JRockit 虚拟机内部不包含解释器实现，全部代码都靠即时编译器编译后执行（特定服务器最快）。

IBM 公司的 J9 VM 则是一款比较通用的虚拟机，其定位应用于从服务端到桌面应用再到嵌入式的多用途虚拟机。IBM 公司开发 J9 VM 的目的是将其作为 IBM 公司各种 Java 产品的执行平台。



## 武林外传：那些无名虚拟机

从 Sun Classic、Sun Exact VM、Sun HotSpot VM，再到 BEA JRockit、IBM J9 VM，这几个虚拟机可以说是虚拟机的正史了，是每个 Java 程序员应该了解的。但在这之外，其实还有各种各样的虚拟机存在。

例如性能最强悍的并不是上面所说的虚拟机，而是名为 Azul VM 和 BEA Liquid VM 的专用商业及虚拟机。这些虚拟机只运行在特定硬件平台，因此要求比较高。但其性能也是非常强悍的。其可以管理至少数十个 CPU 和数百 GB 的内存资源，还提供在巨大内存范围内实现可控 GC 时间的垃圾收集器等等。

此外还有许许多多其他的虚拟机存在，例如：Apache Harmony、Google Android Dalvik VM、Mircosoft JVM 等等。



## 最后的赢家：Oracle

看了这么些历史，似乎都是在说 Sun公司发布的虚拟机，与 Oracle 似乎没有什么关系。但在 2010 年，Oracle 公司收购了 Sun 公司，这样 Oracle 就拥有了 HotSpot VM。再加上其在 2008 年收购 BEA 公司获得的 JRockit VM，Oracle 公司就拥有了地球上最优秀的两款虚拟机。



# JVM各个版本特性





# JVM整体架构

<img src="https://gitee.com/firewolf/allinone/raw/master/images/image-20200817140202381.png" with="500" height="500" />



​	 <font color=red>运行时数据区中：方法区和堆是线程共享的；栈和队列、本地方法栈、程序计数器等是线程私有的</font>

# JVM架构模型

**Java编译器输入的指令流基本上是一种基于`栈的指令集架构`,另外一种指令集架构则是基于`寄存器的指令集架构`**

具体来说:这两种架构之间的区别:

- 基于栈式架构的特点
  - 设计和实现更简单,适用于资源受限的系统;
  - 避开了寄存器的分配难题:使用零地址指令方式分配;
  - 指令流中的指令大部分是零地址指令,其执行过程依赖与操作栈,指令集更小,编译器容易实现;
  - 不需要硬件支持,可移植性更好,更好实现跨平台。
- 基于寄存器架构的特点
  - 典型的应用是x86的二进制指令集:比如传统的PC以及Android的Davlik虚拟机。
  - 指令集架构则完全依赖硬件,可移植性差。
  - 性能优秀和执行更高效。
  - 花费更少的指令去完成一项操作。
  - 在大部分情况下,基于寄存器架构的指令集往往都以一地址指令、二地址指令和三地址指令为主,而基于栈式架构的指令集却是以零地址指令为主。

**总结:**
 `由于跨平台性的设计,Java的指令都是根据栈(PC寄存器除外)来设计的。`不同平台CPU架构不同,所以不能设计为基于寄存器的。优点是跨平台,指令集小,编译器容易实现,缺点是性能下降,实现同样的功能需要更多的指令。

时至今日,尽管嵌入式平台已经不是Java程序的主流运行平台了(准确来说应该是HotSpotVM的宿主环境已经不局限于嵌入式平台了),那么为什么不将架构更换为基于寄存器的架构呢?

栈和队列:
 跨平台性、指令集小、指令多;执行性能比寄存器差。

# Java技术体系结构

![image-20200817131446914](https://gitee.com/firewolf/allinone/raw/master/images/image-20200817131446914.png)

