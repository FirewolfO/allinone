# Shell变量特点

Shell是一种动态类型语言和弱类型语言，即在Shell中，变量的数据类型无需显示地声明，变量的数据类型会根据不同的操作有所变化。准确地讲，Shell中的变量是不分数据类型的，统一地按照字符串存储。但是根据变量的上下文环境，允许程序执行一些不同的操作，例如字符串的比较和整数的加减等。

在Shell中，通常情况下用户可以直接使用变量，无需先进行定义，当用户第一次使用某个变量名时，实际上就同时定义了这个变量，在变量的作用域内，用户都可以使用该变量



# 定义变量

可以用如下两种方式定义变量：

### 变量名=变量值

示例：

a=10

### declare命令

语法：

```pow
declare [+/-][rxi][变量名称＝设置值] 或 declare -f
```

选项：

- +/- ："-"可用来指定变量的属性，"+"则是取消变量所设的属性。
- -f ：仅显示函数。
- r ：将变量设置为只读。
- x ：指定的变量会成为环境变量，可供shell以外的程序来使用。
- i ：[设置值]可以是数值，字符串或运算式。

示例：

```powershell
#! /bin/bash
declare -i b
b=12345
echo $b

b="hellowold"
echo $b

declare +i b
b="hello"
echo $b

declare -r b 
echo $b
b="word"
echo $b

```

结果如下：

```shell
12345  # 正常值
0 # 因为前面是数值类型的，不能更改类型
hello  # 取消类型后可以设置了
hello
var.sh: line 15: b: readonly variable # 只读不能修改
hello

```



# 引用变量

引用变量主要通过$符号来进行引用，有如下几种情况：

### 普通引用

```powershell
name=zhangsan
echo $name
```

### 使用{}

下面这种情况，如果不用{}，变量会被误认为是name2，此时我们需要使用{}来明确变量的名字

```powershell
name=zhangsan
echo $name2  # 会输出空
echo ${name}2
```



# 引号中的变量

在shell中，有三种类型的引号，在这三种引号中的变量引用，出现的效果也各不相同；

- 双引号 ""：，除“$”、“\”、“`”和“"”这几个字符仍是特殊字符并保留其特殊功能外，其余字符仍作为普通字符对待。
- 单引号 ''：都作为普通字符出现
- 反引号``：被Shell解释为命令。

示例：

```powershell
#!/bin/bash 
name=zhangsan
echo "my name is $name , \$name "
echo "current work dir is `pwd`"
echo 'current work dir is `pwd`'
```

输出如下：

```
my name is zhangsan , $name 
current work dir is /lx/shell
current work dir is `pwd`
```



# 命令替换

所谓命令替换，是指在Shell程序中，将某个Shell命令的执行结果赋给某个变量。在bash中，有两种语法可以进行命令替换，分别使用反引号和圆括号，如下：

```powershell
`shell_command`
$(shell_command)
```



# 变量作用域

### 全局变量

通常认为，全局变量是使用范围较大的变量，它不仅限于某个局部使用。在Shell语言中，全局变量可以在脚本中定义，也可以在某个函数中定义。在脚本中定义的变量都是全局变量，其作用域为从被定义的地方开始，一直到Shell脚本结束或者被显式地删除。

在函数中定义的全局变量，一旦函数被调用，那么这个变量的赋值就生效了；

示例：

```powershell
#! /bin/bash
name=zhansan
# 定义函数
func1()
{
  echo $name
  age=40
}
echo "age=$age"
func1 #调用函数
echo "age=$age"
echo "name=$name"

```

结果：

```
age=
zhansan
age=40
name=zhansan
```

### 局部变量

与全局变量相比，局部变量的使用范围较小，通常仅限于某个程序段访问，例如函数内部。

局部变量有两种：

- 函数中使用local修饰的变量
- 函数的入参



# 系统变量

Shell语言的系统变量主要在对参数判断和命令返回值判断时使用，包括脚本和函数的参数，以及脚本和函数的返回值，系统变量如下：

我们给脚本传入参数，在脚本里面接受这些参数使用，通过下面这些变量名来获取参数

| 变量名 | 含义                                         |
| ------ | -------------------------------------------- |
| $n     | 表示传递给脚本的第n个参数                    |
| $#     | 命令行参数的个数                             |
| $0     | 当前脚本的名字                               |
| $*     | 以"参数1参数2参数3...."的形式返回所有参数    |
| $@     | 以"参数1 参数2 参数3....."的形式返回所有参数 |
| $_     | 保存之前执行命令的最后一个参数               |
| $?     | 前一个命令或者函数的返回状态码               |
| $$     | 返回本程序的进行ID                           |

注意实现：

- 对于包含空白字符或者其他的特殊字符的参数，需要使用单引号或者双引号进行传递。
- 变量$#返回传递给脚本的参数的数量，不包括$0，即排除脚本的名称；
- 传递参数的时候，有特殊字符的参数需要用引号引起来。（单引号或者双引号，后面讲解）
- 如果用户传递的参数多于9个，则不能使用$10来引用第10个参数。为了能够获取第10个参数的值，用户必须处理或保存第1个参数，即$1，然后使用shift命令删除参数1并将所有剩余的参数下移1位，此时$10就变成了$9，依此类推。$#的值将被更新以反映参数的剩余数量。或者使用${10}这种方式来获取；



# 环境变量

Shell的环境变量是所有Shell程序都可以使用的变量。Shell程序在运行时，都会接收一组变量，这组变量就是环境变量。环境变量会影响到所有脚本的执行结果，可以使用set命令查看所有的环境变量



# 清空变量

通过unset命令可以清空变量。

如：

```powershell
#!/bin/bash
name=zhangsan
echo $name
unset name 
echo $name
```

结果：

```
zhangsan


```

